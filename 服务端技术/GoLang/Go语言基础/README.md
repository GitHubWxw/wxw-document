?> Go语言入门



### Go语言简介

Go语言（或 Golang）起源于 2007 年，并在 2009 年正式对外发布。Go 是非常年轻的一门语言，它的主要目标是“兼具 [Python](http://c.biancheng.net/python/) 等动态语言的开发速度和 C/[C++](http://c.biancheng.net/cplus/) 等编译型语言的性能与安全性”。

Go语言是编程语言设计的又一次尝试，是对类C语言的重大改进，它不但能让你访问底层操作系统，还提供了强大的网络编程和并发编程支持。Go语言的用途众多，可以进行网络编程、系统编程、并发编程、分布式编程。

Go语言的推出，旨在不损失应用程序性能的情况下降低代码的复杂性，具有“部署简单、并发性好、语言设计良好、执行性能好”等优势，目前国内诸多 IT 公司均已采用Go语言开发项目。

Go语言有时候被描述为“C 类似语言”，或者是“21 世纪的C语言”。Go 从C语言继承了相似的表达式语法、控制流结构、基础数据类型、调用参数传值、指针等很多思想，还有C语言一直所看中的编译后机器码的运行效率以及和现有操作系统的无缝适配。

因为Go语言没有类和继承的概念，所以它和 [Java](http://c.biancheng.net/java/) 或 C++ 看起来并不相同。但是它通过接口（interface）的概念来实现多态性。Go语言有一个清晰易懂的轻量级类型系统，在类型之间也没有层级之说。因此可以说Go语言是一门混合型的语言。

此外，很多重要的开源项目都是使用Go语言开发的，其中包括 [Docker](http://c.biancheng.net/docker/)、Go-Ethereum、Thrraform 和 Kubernetes。

- 相关文章：[传送门](https://www.yuque.com/lengyuezuixue/vdhg2e/xikfi4) 

#### 1.1 关于 Go语言

Go 使用编译器来编译代码。编译器将源代码编译成二进制（或字节码）格式；在编译代码时，编译器检查错误、优化性能并输出可在不同平台上运行的二进制文件。要创建并运行 Go 程序。

在Go语言出现之前，开发者们总是面临非常艰难的抉择，究竟是使用执行速度快但是编译速度并不理想的语言（如：C++），还是使用编译速度较快但执行效率不佳的语言（如：.NET、Java），或者说开发难度较低但执行速度一般的动态语言呢？显然，Go语言在这 3 个条件之间做到了最佳的平衡：快速编译，高效执行，易于开发。

Go语言也称为 Golang，是由 Google 公司开发的一种静态强类型、编译型、并发型、并具有垃圾回收功能的编程语言。

#### 1.2 GO 的特性

- 自动垃圾回收
- 更丰富的内置类型
- 函数多返回值
- 错误处理
- 匿名函数和闭包
- 类型和接口
- 并发编程
- 反射
- 语言交互性

> 自动垃圾回收

从C到C++，从程序性能的角度来考虑，这两种语言允许程序员自己管理内存，包括内存的申请和释放等。因为没有垃圾回收机制所以C/C++运行起来速度很快，但是随之而来的是程序员对内存使用上的谨小慎微的考虑。因为哪怕一点不小心就可能会导致“内存泄露”使得资源浪费或者“野指针”使得程序崩溃等，尽管C++11后来使用了智能指针的概念，但是程序员仍然需要很小心的使用。后来为了提高程序开发的速度以及程序的健壮性，java和C#等高级语言引入了GC机制，即程序员不需要再考虑内存的回收等，而是由语言特性提供垃圾回收器来回收内存。但是随之而来的可能是程序运行效率的降低。
      “Go语言作为一门新生的开发语言，当然不能忽略内存管理这个问题。又因为Go语言没有C++这么“强大”的指针计算功能，因此可以很自然地包含垃圾回收功能。因为垃圾回收功能的支持，开发者无需担心所指向的对象失效的问题，因此Go语言中不需要delete关键字，也不需要free()方法来明确释放内存”.

> 更丰富的内置类型

其实作为一种新兴的语言，如果仅仅是为了某种特定的用途那么可能其内置类型不是很多，仅需要能够完成我的功能即可，但是Go语言“不仅支持几乎所有语言都支持的简单内置类型（比如整型 int32和浮点型等float64）外，还支持一些其他的高级类型，比如字典类型，map要知道这些类型在其他语言中都是通过包的形式引入的外部数据类型。数组切片（Slice），类似于C++ STL中的vector，在Go也是一种内置的数据类型作为动态数组来使用。这里满有一个颇为简单的解释：”既然绝大多数开发者都需要用到这个类型，为什么还非要每个人都写一行import语句来包含一个库？”

> 函数多返回值

在C，C++中，包括其他的一些高级语言是不支持多个函数返回值的。但是这项功能又确实是需要的，所以在C语言中一般通过将返回值定义成一个结构体，或者通过函数的参数引用的形式进行返回。而在Go语言中，作为一种新型的语言，目标定位为强大的语言当然不能放弃对这一需求的满足，所以支持函数多返回值是必须的，例如：

```go
// //定义了一个多返回值的函数getName
func getName()(firstName, middleName, lastName, nickName string){
        return "May", "M", "Chen", "Babe" 
 } 
 
 fn, mn, ln, nn := getName()      //调用赋值
 _, _, lastName, _ := getName()   //缺省调用
```

> 错误处理

在传统的OOP编程中，为了捕获程序的健壮性需要捕获异常，使用的方法大都是try() catch{}模块，例如, 在下面的java代码中，可能需要的操作是：

```java
Connection conn = ...;
try {
    Statement stmt = ...;
    ...//别的一些异常捕获
finally {
    stmt.close();
    }
finally {
    conn.close(); 
}
```

而在Go中引入了三个关键字，分别是 **defer、panic和recover**，其中使用defer关键字语句的含义是不管程序是否出现异常，均在函数退出时自动执行相关代码。
所以上面你的java代码用Go进程重写只有两行：

```go
conn := ...
defer conn.Close()12
```

另外两个关键词后面再讨论。所以“Go语言的错误处理机制可以大量减少代码量，让开发者也无需仅仅为了程序安全性而添加大量一层套一层的try-catch语句。这对于代码的阅读者和维护者来说也是一件很好的事情，因为可以避免在层层的代码嵌套中定位业务代码。”

> **匿名函数和闭包**  参考文章：https://www.yuque.com/lengyuezuixue/vdhg2e/xikfi4

- **匿名函数**

  匿名函数是指不需要定义函数名的一种函数实现方式。

  在Go语言中，函数可以像普通变量一样被传递或使用，这与C语言的回调函数比较类似。不同的是，Go语言支持随时在代码里定义匿名函数。

匿名函数由一个不带函数名的函数声明和函数体组成，如下所示：

```go
func(参数列表)(返回参数列表){
    函数体
}
```

> **在定义时调用匿名函数**

```go
func(data int) {
    fmt.Println("hello", data)
}(100)
// 注意第3行}后的(100)，表示对匿名函数进行调用，传递参数为 100。
```

> **将匿名函数赋值给变量**

```go
// 将匿名函数体保存到f()中
f := func(data int) {
    fmt.Println("hello", data)
}
// 使用f()调用
f(100)
```

> **匿名函数用作回调函数** 

下面的代码实现对切片的遍历操作，遍历中访问每个元素的操作使用匿名函数来实现，用户传入不同的匿名函数体可以实现对元素不同的遍历操作，代码如下：

- **闭包**

  Go 的匿名函数是一个闭包。

  闭包是可以包含自由(未绑定到特定对象)变量的代码块，这些变量不在这个代码快或者任何全局上下文中定义，而是在定义代码块的环境中定义。要执行的代码块(由于自由变量包含在代码块中，所以这些自由变量以及它们引用的对象的没有被释放)为自由变量提供绑定的计算环境(作用域)。

> 类型和接口

#### 1.3 Go 语言编译与工具

Go 语言的工具链非常丰富，从获取源码、编译、文档、测试、性能分析，到源码格式化、源码提示、重构工具等应有尽有。

在 Go 语言中可以使用测试框架编写单元测试，使用统一的命令行即可测试及输出测试报告的工作。基准测试提供可自定义的计时器和一套基准测试算法，能方便快速地分析一段代码可能存在的 CPU 耗用和内存分配问题。性能分析工具可以将程序的 CPU 耗用、内存分配、竞态问题以图形化方式展现出来。  

1. [go build命令（go语言编译并打包命令）完全攻略](http://c.biancheng.net/view/120.html) 

2. [go clean命令——清除编译文件](http://c.biancheng.net/view/4440.html) 

3. [go run命令——编译并运行](http://c.biancheng.net/view/121.html) 

4. [go fmt命令——格式化代码文件](http://c.biancheng.net/view/4441.html) 

5. [go install命令——编译并安装](http://c.biancheng.net/view/122.html) 

6. [go get命令——一键获取代码、编译并安装](http://c.biancheng.net/view/123.html) 

7. [go generate命令——在编译前自动化生成某类代码](http://c.biancheng.net/view/4442.html) 

8. [go test命令（Go语言测试命令）完全攻略](http://c.biancheng.net/view/124.html) 

9. [go pprof命令（Go语言性能分析命令）完全攻略](http://c.biancheng.net/view/125.html) 

### Go语言基本语法

#### 2.1 变量和常量

#### 2.2 基本数据类型

- 整型
- 浮点型
- 复数
- bool型
- 字符串

### Go语言文件处理

### Go语言并发

并发指在同一时间内可以执行多个任务。并发编程含义比较广泛，包含多线程编程、多进程编程及分布式程序等。本章讲解的并发含义属于多线程编程。

Go 语言通过编译器运行时（runtime），从语言上支持了并发的特性。Go 语言的并发通过 **goroutine** 特性完成。goroutine 类似于线程，但是可以根据需要创建多个 goroutine 并发工作。goroutine 是由 Go 语言的运行时调度完成，而线程是由操作系统调度完成。

Go 语言还提供 **channel** 在多个 goroutine 间进行通信。goroutine 和 channel 是 Go 语言秉承的 CSP（Communicating Sequential Process）并发模式的重要实现基础。本章中，将详细为大家讲解 goroutine 和 channel 及相关特性。  

#### 4.1 Go语言并发概述

















































